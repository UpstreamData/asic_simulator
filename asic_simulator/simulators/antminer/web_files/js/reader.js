!function(e){var t={};function r(i){if(t[i])return t[i].exports;var s=t[i]={i:i,l:!1,exports:{}};return e[i].call(s.exports,s,s.exports,r),s.l=!0,s.exports}r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)r.d(i,s,function(t){return e[t]}.bind(null,s));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/",r(r.s=8)}({8:function(e,t,r){"use strict";r.r(t);function i(e){var t=new Uint32Array(1);return t[0]=(255&e[3])<<24,t[0]=t[0]|(255&e[2])<<16,t[0]=t[0]|(255&e[1])<<8,t[0]=t[0]|255&e[0],t[0]}class s{constructor(){this.Magic=0,this.Versoin=0,this.HdrSize=0,this.ItemCount=0,this.ItemSize=0,this.DataOffset=0,this.Crc32=0,this.Reserve0=0,this.Reserve1=0}parseHdr(e){this.Magic=i(e.subarray(0,4)),this.Versoin=i(e.subarray(4,8)),this.HdrSize=i(e.subarray(8,12)),this.ItemCount=i(e.subarray(12,16)),this.ItemSize=i(e.subarray(16,20)),this.DataOffset=i(e.subarray(20,24)),this.Crc32=i(e.subarray(24,28)),this.Reserve0=i(e.subarray(28,32)),this.Reserve1=i(e.subarray(32,36))}printfHdr(){console.log("read header:"),console.log("magic 0x"+this.Magic.toString(16)),console.log("version 0x"+this.Versoin.toString(16)),console.log("hdrsize 0x"+this.HdrSize.toString(16)),console.log("itemcount 0x"+this.ItemCount.toString(16)),console.log("itemsize 0x"+this.ItemSize.toString(16)),console.log("dataoffset 0x"+this.DataOffset.toString(16)),console.log("crc32 0x"+this.Crc32.toString(16)),console.log("reserve0 0x"+this.Reserve0.toString(16)),console.log("reserve1 0x"+this.Reserve1.toString(16))}}class o{constructor(){this.NameLen=0,this.ChipModelLen=0,this.CtrlBoardModelLen=0,this.MinerModelLen=0,this.Name="",this.ChipModel="",this.CtrlBoardModel="",this.MinerModel="",this.DataOffset=0,this.DataSize=0}parseItem(e){this.NameLen=e.subarray(0,1),this.ChipModelLen=e.subarray(1,2),this.CtrlBoardModelLen=e.subarray(2,3),this.MinerModelLen=e.subarray(3,4),this.Name=a(e.subarray(4,68),this.NameLen),this.ChipModel=a(e.subarray(68,100),this.ChipModelLen),this.CtrlBoardModel=a(e.subarray(100,132),this.CtrlBoardModelLen),this.MinerModel=a(e.subarray(132,164),this.MinerModelLen),this.DataOffset=i(e.subarray(164,168)),this.DataSize=i(e.subarray(168,172))}printfItem(){console.log("read item:"),console.log("namelen 0x"+this.NameLen.toString(16)),console.log("chipmodellen 0x"+this.ChipModelLen.toString(16)),console.log("ctrlboardmodellen 0x"+this.CtrlBoardModelLen.toString(16)),console.log("minermodellen 0x"+this.MinerModelLen.toString(16)),console.log("name "+this.Name),console.log("chipmodel "+this.ChipModel),console.log("ctrlboardmodel "+this.CtrlBoardModel),console.log("minermodel "+this.MinerModel),console.log("dataoffset 0x"+this.DataOffset.toString(16)),console.log("datasize 0x"+this.DataSize.toString(16))}}function a(e,t=256){var r="",i=e.length;t<e.length&&(i=t);for(var s=0;s<i;s++)r+=String.fromCharCode(e[s]);return r}t.default=class{constructor(){this.READ_AS_TEXT=1,this.READ_AS_BINARY_STRING=2,this.READ_AS_ARRAY_BUFFER=3,this.READ_AS_DATA_URL=4,this.reader=[],this.flag=[],this.sizeMap=[],this.fileCount=0,this.loadedMap=[],this.totalLoaded=0,this.loaded=0,this.total=0,this.progress=0,this.allProgress=[],this.hdr=new s,this.items=[],this.status=0,this.sum=0,this.oldsum=0,this.matched=!1,this.table=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117]}readAsText(e,t,r,i="utf-8"){this.allProgress[++this.fileCount]=[],this.flag[this.fileCount]=[],this.loadedMap[this.fileCount]=[],this.total+=e.size,this.reader[this.fileCount]=new FileReader,this.sizeMap[this.fileCount]=e.size,console.log("read as text ~"),this.initReader(this.READ_AS_TEXT,this.fileCount,r,e,t),this.reader[this.fileCount].readAsText(0===r?e:this.blobSlice(e,0,r),i)}readAsBinaryString(e,t,r){this.allProgress[++this.fileCount]=[],this.flag[this.fileCount]=[],this.loadedMap[this.fileCount]=[],this.total+=e.size,this.reader[this.fileCount]=new FileReader,this.sizeMap[this.fileCount]=e.size,this.initReader(this.READ_AS_BINARY_STRING,this.fileCount,r,e,t),this.reader[this.fileCount].readAsBinaryString(0===r?e:this.blobSlice(e,0,r))}readAsArrayBuffer(e,t,r,i,s){this.allProgress[++this.fileCount]=[],this.flag[this.fileCount]=[],this.loadedMap[this.fileCount]=[],this.total+=e.size,this.reader[this.fileCount]=new FileReader,this.sizeMap[this.fileCount]=e.size,console.log("read as array buffer ~ filesize:"+e.size+" type:"+this.READ_AS_ARRAY_BUFFER),this.initReader(this.READ_AS_ARRAY_BUFFER,this.fileCount,r,e,t,i,s),this.reader[this.fileCount].readAsArrayBuffer(0===r?e:this.blobSlice(e,0,r))}checkHeader(e,t){var r=new FileReader,s=e.size,o=0,a=this;r.onload=function(l){var n=function(e,t,r){t==window.undefined&&(t=0);t=(-1^t)>>>0;for(var i=0,s=e.byteLength;i<s;i++)t=t>>>8^r[255&(t^e[i])];return(-1^t)>>>0};if(0===o){var d=new Uint8Array(l.target.result).subarray(0,36);a.oldsum=i(d.subarray(24,28)),d[24]=0,d[25]=0,d[26]=0,d[27]=0,a.sum=n(d,0,a.table),a.sum=n(new Uint8Array(l.target.result).subarray(36,16384),a.sum,a.table),console.log("start read result len:",l.target.result.byteLength)}else a.sum=n(new Uint8Array(l.target.result).subarray(16*o*1024,l.loaded),a.sum,a.table),console.log("crc32 read result len:",l.target.result.byteLength,"sum:0x"+a.sum.toString(16));if(console.log("result.load:",l.loaded,"filesize:",s),l.loaded>=s){var h=Boolean(!1);return a.sum===a.oldsum&&0!=a.sum&&(h=Boolean(!0)),t(h,a.sum.toString(16)+"->"+a.oldsum.toString(16)),void console.log("read end sum=0x",a.sum.toString(16),"->oldsum:",a.oldsum.toString(16),"checked:",h)}o++,r.readAsArrayBuffer(e,16*o*1024,16*(o+1)*1024)},r.readAsArrayBuffer(this.blobSlice(e,0,16384))}readAsDataURL(e,t){var r=this,i=this.reader[++this.fileCount]=new FileReader;i.onload=function(e){t(e.target.result),delete r.reader[r.fileCount],r.fileCount--},i.readAsDataURL(e)}initReader(e,t,r,i,s,a="",l=""){var n=0,d=this,h=function(e){d.loadedMap[t]=r*n+e.loaded-r,d.loaded=0,d.loadedMap.forEach((function(e){d.loaded+=e}),this),d.allProgress[t]=(d.loadedMap[t]/d.sizeMap[t]*100).toFixed(2),d.progress=(d.loaded/d.total*100).toFixed(2),console.log("total: "+d.total),console.log("loaded: "+d.loaded),console.log(t+": "+d.allProgress[t]+"%"),console.log("\n")};console.log("initreader type:",e),d.reader[t].onload=function(u){var f=null;if(e===this.READ_AS_TEXT){console.log("======================"+e+" this:"+this.READ_AS_TEXT);for(var c=u.target.result,g=0,A=0;A<c.length;++A)"\n"!==c[A]&&"\r"!==c[A]&&A!==c.length-1||(s(c.slice(g,A)),g=A)}else if(console.log("---------------------"),e===d.READ_AS_ARRAY_BUFFER)if(0===n){var S=new Uint8Array(u.target.result).subarray(0,36);d.hdr.parseHdr(S);var m=new Uint8Array(u.target.result).subarray(36,d.hdr.ItemSize*d.hdr.ItemCount+36);for(A=0;A<d.hdr.ItemCount;A++){var R=new o;R.parseItem(m.subarray(A*d.hdr.ItemSize,(A+1)*d.hdr.ItemSize)),d.items[A]=R}var b=-1;if(""!=a)for(A=0;A<d.hdr.ItemCount;A++)if(d.items[A].MinerModel===a&&d.items[A].CtrlBoardModel===l){console.log("find file miner_type:",a," subtype:",l),b=A;break}if(-1===b)return console.log("can not find minertype file,minertype:",a),d.matched=!1,void s(u.target.result,d.matched);d.matched=!0,f=d.items[b],d.total=f.DataSize,d.sizeMap[t]=f.DataSize,d.loadedMap[t]=0,d.loaded=0}else console.log("call back data length:",u.target.result.byteLength),s(u.target.result,d.matched);else s(u.target.result);if(null!==f||0!=n){if(console.log("start :",n,"step:",r),0!=n&&h(u),0!==r){if(console.log("loadmap: "+d.loadedMap[t]+" sizemap: "+d.sizeMap[t]),!(d.loadedMap[t]<d.sizeMap[t]))return delete d.reader[t],void d.fileCount--;n++,console.log("read blob targetItem offset:"+f.DataOffset+" size:"+f.DataSize),function(e,r,i,s){var o=d.blobSlice(s,r,r+i);e===d.READ_AS_TEXT?d.reader[t].readAsText(o):e===d.READ_AS_BINARY_STRING?d.reader[t].readAsBinaryString(o):e===d.READ_AS_ARRAY_BUFFER&&d.reader[t].readAsArrayBuffer(o)}(e,f.DataOffset,f.DataSize,i)}}else console.log("can not get invalid file in container")},d.reader[t].onprogress=function(e){0!=n&&h(e)}}read(e,t,r,i){if(this.allProgress[++this.fileCount]=[],this.flag[this.fileCount]=[],this.loadedMap[this.fileCount]=[],this.total+=t.size,this.reader[this.fileCount]=new FileReader,this.sizeMap[this.fileCount]=t.size,e===this.READ_AS_TEXT)this.initReader(this.READ_AS_TEXT,this.fileCount,i,t,r),this.reader[this.fileCount].readAsText(0===i?t:s.blobSlice(t,0,1024*i));else if(e===this.READ_AS_BINARY_STRING)this.initReader(this.READ_AS_BINARY_STRING,this.fileCount,i,t,r),this.reader[this.fileCount].readAsBinaryString(0===i?t:s.blobSlice(t,0,1024*i));else if(e===this.READ_AS_ARRAY_BUFFER)this.initReader(this.READ_AS_ARRAY_BUFFER,this.fileCount,i,t,r),this.reader[this.fileCount].readAsArrayBuffer(0===i?t:s.blobSlice(t,0,1024*i));else if(e===this.READ_AS_DATA_URL){var s=this;s.reader[s.fileCount].onload=function(e){r(e.target.result),delete s.reader[s.fileCount],s.fileCount--},s.reader[s.fileCount].readAsDataURL(t)}}blobSlice(e,t,r){return e.slice?e.slice(t,r):e.webkitSlice?e.webkitSlice(t,r):e.mozSlice?e.mozSlice(t,r):null}createProcessBar(){var e=document.createElement("progress");return e.max=100,e}getProgress(){return this.progress}getOneProgress(e){return this.allProgress[e]}getProgressBar(){return this.progressBar}getKums(e){e(this.sum.toString(16))}}}});
